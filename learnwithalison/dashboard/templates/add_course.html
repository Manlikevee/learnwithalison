{% extends 'dashlayout.html' %}
{% load static %}
{% block content %}

<div class="container-fluid">

  <!-- PAGE TITLE -->
  <div class="page-title-head d-flex align-items-center">
    <div class="flex-grow-1">
      <h4 class="fs-xl fw-bold m-0">Add New Course</h4>
    </div>

    <div class="text-end">
      <ol class="breadcrumb m-0 py-0">
        <li class="breadcrumb-item">
          <a href="{% url 'admin_dashboard' %}">Dashboard</a>
        </li>
        <li class="breadcrumb-item">
          <a href="{% url 'admin_courses' %}">Courses</a>
        </li>
        <li class="breadcrumb-item active">New Course</li>
      </ol>
    </div>
  </div>

  <!-- FORM -->
  <form method="POST" enctype="multipart/form-data" class="mt-3">
    {% csrf_token %}

    <div class="row g-3">

      <!-- LEFT -->
      <div class="col-xl-8">

        <div class="card">
          <div class="card-header">
            <h5 class="card-title mb-0">Course Information</h5>
          </div>
          <div class="card-body">

            <div class="row g-3">
              <div class="col-12">
                <label class="form-label">Course Title</label>
                <input type="text" name="title"
                       class="form-control"
                       required>
              </div>

              <div class="col-md-6">
                <label class="form-label">
                  Category
                  <a href="{% url 'admin_categories' %}"
                     class="text-primary fs-xs ms-2">
                    + Add Category
                  </a>
                </label>
                <select name="category" class="form-select" required>
                  <option value="">Select category</option>
                  {% for category in categories %}
                    <option value="{{ category.id }}">{{ category.name }}</option>
                  {% endfor %}
                </select>
              </div>

              <div class="col-md-6">
                <label class="form-label">Course Level</label>
                <select name="level" class="form-select">
                  <option value="beginner">Beginner</option>
                  <option value="intermediate">Intermediate</option>
                  <option value="advanced">Advanced</option>
                </select>
              </div>

              <div class="col-12">
                <label class="form-label">Short Description</label>
                <input type="text" name="short_description"
                       class="form-control">
              </div>

              <div class="col-12">
                <label class="form-label">Full Description</label>
                <textarea name="description"
                          class="form-control"
                          rows="4"></textarea>
              </div>
            </div>

          </div>
        </div>

      </div>

      <!-- RIGHT -->
      <div class="col-xl-4">

        <!-- THUMBNAIL -->
        <div class="card">
          <div class="card-header">
            <h5 class="card-title mb-0">Thumbnail</h5>
          </div>
          <div class="card-body text-center">
            <img id="thumbnailPreview"
                 class="img-fluid rounded mb-3 d-none">
            <input type="file" name="thumbnail"
                   class="form-control"
                   id="thumbnailInput">
          </div>
        </div>

        <!-- PRICING -->
        <div class="card">
          <div class="card-header">
            <h5 class="card-title mb-0">Pricing</h5>
          </div>
          <div class="card-body">

            <select name="price_type" class="form-select mb-3" id="priceType">
              <option value="free">Free</option>
              <option value="paid">Paid</option>
            </select>

            <div class="mb-3 d-none" id="priceField">
              <input type="number" name="price"
                     class="form-control"
                     placeholder="Enter amount">
            </div>

            <select name="status" class="form-select">
              <option value="draft">Draft</option>
              <option value="published">Published</option>
            </select>

          </div>
        </div>

      </div>
    </div>

    <div class="mt-4 d-flex justify-content-end gap-3">
      <a href="{% url 'admin_courses' %}" class="btn btn-light btn-lg">
        Cancel
      </a>
      <button type="submit" class="btn btn-primary btn-lg px-5">
        Save & Continue
      </button>
    </div>

  </form>
</div>

<script>
  document.getElementById("thumbnailInput").addEventListener("change", e => {
    const img = document.getElementById("thumbnailPreview");
    img.src = URL.createObjectURL(e.target.files[0]);
    img.classList.remove("d-none");
  });

  document.getElementById("priceType").addEventListener("change", e => {
    document.getElementById("priceField")
      .classList.toggle("d-none", e.target.value !== "paid");
  });
</script>

{% endblock %}
